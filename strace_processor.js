const fs = require("fs");

/*
// MESHES
const ids = [
    6270612838,
    6271088115,
    6274500767,
    6271478266,
    6274476515,
    6270595186,
    6270961362,
    6473891932,
    6268961444,
    7451107511,
    8116982960,
    8116981443,
    8116985908,
    8116870420,
    8117413092,
    7047310524,
    7047322492,
    7047317444,
    6550393507,
    6786135223,
    6786136822,
    6975683751,
    6323243162,
    7050937452,
    7202322854,
    8117663686,
    8117678640,
    8117649608,
    6967682732,
    6967622540,
    6967667772,
    6967640580,
    7051659945,
    7051519067,
    7051491934,
    7051672042,
    7051344842,
    7051330082,
    7051329625,
    7050210428,
    7050127655,
    7050164445,
    7050054719,
    7050143551,
    7050171476,
    7050015752,
    7049986137,
    7050009250,
    7049981974,
    7050955572,
    7026097620,
    7026041272,
    7026032044,
    7026111862,
    7026110554,
    7051065992,
    7051080502,
    7051065366,
    7050930022,
    7050831472,
    7050928434,
    7032850487,
    7657995376,
    7657987016,
    8917314551,
    8917313803,
    8917338413,
    8917201394,
    8917234846,
    8917364361,
    7658004983,
    7657977535
];
*/

const ids = [
    201086438,
    202282177,
    7198793762,
    8115996195,
    8116465872,
    8116416310,
    7202202205,
    6549971491,
    6975605142,
    8115955435,

    // "not approved"
    6239835998,
    8795479844,
    7198800836,
    8383276881,
    8585168320
];

const straceLogs = fs.readFileSync("strace.log", "utf8")
    .split("\n");

const files = [];

const entryRegex = /^\d+ lstat\(".*\/Temp\/Roblox\/http\/([a-z0-9]{32})\", 0x[a-f0-9]+\) = -1 ENOENT \(No such file or directory\)$/;

for (const logEntry of straceLogs) {
    const matches = entryRegex.exec(logEntry);
    if (matches && !files.includes(matches[1])) {
        files.push(matches[1]);
        console.log(matches[1]);
    }
}

const output = {};

for (let i = 0; i < files.length; i++) {
    output[ids[i]] = files[i];
}

fs.writeFileSync("asset_mcp_map.json", JSON.stringify(output, undefined, 4));